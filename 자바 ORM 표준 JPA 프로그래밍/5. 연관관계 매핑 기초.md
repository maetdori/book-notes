# 5. 연관관계 매핑 기초

객체는 참조(주소)를 사용해서 관계를 맺고 테이블은 외래 키를 사용해서 관계를 맺는다. 객체의 참조와 테이블의 외래 키를 매핑하는 것이 이 장의 목표다. 

## 5.4 연관관계의 주인

객체에는 양방향 연관관계라는 것이 없다. 서로 다른 단방향 연관관계 2개를 애플리케이션 로직으로 잘 묶어서 양방향인 것처럼 보이게 할 뿐이다. 반면에 데이터베이스 테이블은 외래 키 하나만으로 양방향 연관관계를 맺는다.        

이런 차이로 인해 JPA에서는 두 객체 연관관계 중 하나를 정해서 테이블의 외래키를 관리해야 하는데 이것을 **연관관계의 주인**<sub>owner</sub>이라 한다. 

### 5.4.1 양방향 매핑의 규칙: 연관관계의 주인
* 연관관계의 주인만이 외래 키를 관리(등록, 수정, 삭제)할 수 있다.
* 주인이 아닌 쪽은 읽기만 할 수 있다. (값을 수정해도 DB에 반영되지 않는다.)
* 주인이 아닌 쪽을 `mappedBy` 속성으로 표시한다.
* **연관관계의 주인 == 외래 키 관리자**

## 5.6 양방향 연관관계의 주의점

* 되도록이면 단방향 매핑만을 이용해 설계한다. 
* 양방향 연관관계 매핑 시 양쪽 방향에 모두 값을 입력해주는 것이 가장 안전하다.
  * 연관관계 편의 메소드를 이용한다. 
    ```java
        public class Member {

            private Team team;

            public void changeTeam(Team team) {
                this.team = team;
                team.getMembers().add(this); //**
            }
            ...
        }
    ```
